---
title: "Homelessness Dataset"
output: html_notebook
---

```{r}
library(tidyverse)
library(dplyr)

data1<- read.csv("MOCK_DATA_v1.csv")


data2<- data.frame("Age" = sample(18:80, size= 1000, rep = T), "Date_of_Arrival"=sample(seq(as.Date("2000/1/1"), as.Date("2021/1/1"), by="years"), size= 1000, replace = T), "Total_Days_in_Shelter"= sample(1:100, size=1000, rep = T), "Total_Days_Homeless"=sample(1:100, size=1000, rep = T), "Recurrence"= sample(1:100, size=1000, rep = T), "Party_Size"=sample(1:5, size=1000, rep = T), "Reason" = sample(c( 'Veteran','Domestic Abuse','Foster System', 'Disability'), size = 1000, rep = T))

data<-bind_cols(data1,data2)

risk <- function(reas, TDH, recur){
p<-recur+ TDH
if (reas=="Veteran"){
  p<- p + 100
}
if (reas == "Disability"){
  p<- p + 50
}
if (reas == "Foster System"){
  p<- p + 25
}
return (p)
}

risk.name<- function(pRisk){
  cat<- sample_n(c( 'High','Medium','Low'), weight = pRisk, rep = T)
  return(cat)
}

rescale <- function(x) (x-min(x))/(max(x) - min(x)) * 100
rescale2<- function(x) (x/sum(x))

data.risk<- data %>%
  mutate("P" = risk(Reason, Total_Days_Homeless, Recurrence))%>%
  mutate("pRisk"= rescale2(P))%>%
  mutate("Risk"= sample(c( 'High','Medium','Low'), size=1000, prob = data$pRisk, rep = T))



write_csv(data.risk, "homeless_data4.csv")

```

```{r}
id.data<- data.frame("ID" = 1:100000, "Age" = sample(18:80, size= 100000, rep = T), "Date_of_Arrival"=sample(seq(as.Date("2000/1/1"), as.Date("2021/1/1"), by="years"), size= 100000, replace = T), "Total_Days_in_Shelter"= sample(1:100, size=100000, rep = T), "Total_Days_Homeless"=sample(1:500, size=100000, rep = T), "Recurrence"= sample(1:100, size=100000, rep = T), "Party_Size"=sample(1:5, size=100000, rep = T), "Reason" = sample(c( 'Veteran','Domestic Abuse','Foster System', 'Disability'), size = 100000, rep = T))

id.data.risk<- id.data %>%
  mutate("P" = risk(Reason, Total_Days_Homeless, Recurrence))%>%
  mutate("pRisk"= rescale2(P))%>%
  mutate("Risk"= sample(c( 'High','Medium','Low'), size=100000, prob = data$pRisk, rep = T))

write_csv(data.risk, "id_homeless_data.csv")
```

