---
title: "Homelessness Dataset"
output: html_notebook
---

```{r}
library(tidyverse)
library(dplyr)
library(psych)

data.fake<- read.csv("MOCK_DATA_v1.csv")

risk <- function(reas, TDH, recur){
p<-recur+ TDH
if (reas=="Veteran"){
  p<- p + 100
}
if (reas == "Disability"){
  p<- p + 50
}
if (reas == "Foster System"){
  p<- p + 25
}
return (p)
}

```

```{r}
risk_group<- function(x,top,bottom){
  if (x>= top) {
    return("High")}
  if (x >= bottom && x < top) {
    return("Medium")}
  if (x< bottom) {
    return("Low")}
  else {
    return ("Error")
  }
}

id.data<- data.frame("ID" = 1:100000, "Age" = sample(18:80, size= 100000, rep = T), "Date_of_Arrival"=sample(seq(as.Date("2000/1/1"), as.Date("2021/1/1"), by="years"), size= 100000, replace = T), "Total_Days_in_Shelter"= sample(1:100, size=100000, rep = T), "Total_Days_Homeless"=sample(1:500, size=100000, rep = T), "Recurrence"= sample(1:100, size=100000, rep = T), "Party_Size"=sample(1:5, size=100000, rep = T), "Reason" = sample(c( 'Veteran','Domestic Abuse','Foster System', 'Disability'), size = 100000, rep = T))



id.data.risk<- id.data %>%
  mutate("risk.num" = risk(Reason, Total_Days_Homeless, Recurrence))

bottom.third<- quantile(id.data.risk$risk.num, 0.33, type=7)
top.third<- quantile(id.data.risk$risk.num, 0.66, type=7)

id.data.risk.group <- id.data.risk %>%
  dplyr::mutate("Risk"= risk_group(risk.num, top.third, bottom.third))


write_csv(id.data.risk.group, "id_homeless_data.csv")
```

